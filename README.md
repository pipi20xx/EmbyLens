# EmbyLens

**全能型 Emby 媒体库深度管理与自动化维护工具箱**

EmbyLens 是一款专为私有云媒体服务器设计的综合管理平台。它集成了元数据净化、演员维护、智能去重、深度搜索及 Webhook 联动等多项原子化工具，旨在为 Emby 用户提供一个高效、透明且自动化的运维环境。

---

## 🛠️ 核心功能矩阵

### 1. 媒体库自动化维护
*   **♻️ 智能去重清理 (Dedupe Ultimate)**：
    *   **多维度查重**：支持电影、剧集本体、单集文件（跨目录/硬盘）的精准识别。
    *   **智能评分评分**：基于画质规格、视频编码、动态范围进行自动化优劣筛选。
    *   **安全折叠删除**：识别层级关系，剧集整体删除时仅需一次 API 调用，支持路径白名单保护。
*   **🧹 媒体净化清理**：
    *   批量移除特定标签、流派或无效的演员信息。
    *   一键清理剧集元数据中的冗余字段。
*   **🔒 元数据锁定器**：
    *   批量锁定/解锁媒体字段，防止 Emby 扫描时覆盖手动修改的优质元数据。

### 2. 元数据与演员管理
*   **🏷️ 类型映射管理**：
    *   自定义流派（Genre）映射规则，将繁杂的原始分类统一为干净的展示标签。
*   **👤 演员信息维护**：
    *   基于 TMDB ID 的演员身份深度识别。
    *   支持批量修正、更新或清理媒体库中的演员肖像与姓名。
*   **🔍 项目元数据查询**：
    *   直接调取 Emby 内部最原始的 JSON 响应，方便开发者调试与深度检查。

### 3. TMDB 深度集成
*   **🛰️ TMDB ID 深度搜索**：
    *   全库扫描匹配指定 TMDB ID，支持跨类型深度索引。
*   **🎯 剧集 TMDB 反查**：
    *   根据单集文件 ID，自动回溯并定位其所属剧集的 TMDB 绑定状态。

### 4. 系统集成与监控
*   **🔗 Webhook 接收器**：
    *   监听 Emby 实时事件（如播放、暂停、新增媒体），记录详细日志并支持后续扩展触发。
*   **📊 管理仪表盘**：
    *   直观展示媒体库统计数据、系统状态及审计流水。
*   **📝 实时日志系统**：
    *   全系统操作（同步、删除、分析）秒级反馈，确保每一项后台任务都清晰可见。

---

## ⚡ 工业级性能特性

-   **并发性能**：基于 `asyncio` 的高并发引擎，支持 **10 并发**并行抓取，同步数千部剧集仅需数秒。
-   **全异步架构**：同步、分析、删除任务均在后台运行，不阻塞 UI，完成后自动触发数据状态感知刷新。
-   **配置系统**：彻底去数据库化，所有凭据、规则与白名单均透明存储于 `backend/data/config.json`。
-   **会话管理**：支持管理员模拟登录，动态换取 Session Token，解决高权限删除操作的鉴权难题。

---

## 🏗️ 技术栈

-   **Frontend**: Vue 3 (Composition API) + Vite + TypeScript + Naive UI
-   **Backend**: Python 3.10 + FastAPI + SQLAlchemy (Async) + httpx
-   **Icons**: Material Design Icons (@vicons/material)

---

## 🚀 快速部署 (Docker)

1.  **启动服务**：`docker-compose up -d`
2.  **配置集成**：前往“系统设置”，填入 Emby URL、API Key 及管理员账号密码。
3.  **刷新索引**：进入“重复项清理”，点击“从 Emby 同步”。
4.  **开始维护**：根据需要选择对应的原子化工具进行操作。
