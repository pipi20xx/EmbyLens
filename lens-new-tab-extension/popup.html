<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { width: 320px; padding: 0; margin: 0; font-family: -apple-system, sans-serif; background: #fff; }
        .header { padding: 12px 15px; background: #f8fafc; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
        .header h3 { margin: 0; font-size: 14px; color: #1e293b; }
        .gear-btn { cursor: pointer; color: #64748b; transition: color 0.2s; }
        .gear-btn:hover { color: #2563eb; }
        
        .tabs { display: flex; border-bottom: 1px solid #e2e8f0; background: #f8fafc; }
        .tab { flex: 1; text-align: center; padding: 10px; font-size: 13px; color: #64748b; cursor: pointer; border-bottom: 2px solid transparent; }
        .tab.active { color: #2563eb; border-bottom-color: #2563eb; font-weight: 600; background: #fff; }

        .content { padding: 15px; }
        .view { display: none; }
        .view.active { display: flex; flex-direction: column; gap: 12px; }
        
        .field { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 12px; color: #64748b; font-weight: 500; }
        input, select { padding: 8px 10px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px; outline: none; }
        input:focus { border-color: #2563eb; }
        
        .preview { display: flex; align-items: center; gap: 10px; padding: 10px; background: #f1f5f9; border-radius: 8px; }
        .preview img { width: 32px; height: 32px; object-fit: contain; }
        
        .btn { padding: 10px; background: #2563eb; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; }
        .btn:hover { background: #1d4ed8; }
        .btn-secondary { background: #94a3b8; margin-top: 5px; }
        
        .status { font-size: 12px; text-align: center; margin-top: 8px; }
        .success { color: #10b981; }
        .error { color: #ef4444; }

        /* 模态框样式 */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(15, 23, 42, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(2px);
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            width: 260px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            animation: modalShow 0.2s ease-out;
        }
        @keyframes modalShow {
            from { opacity: 0; transform: scale(0.95) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .modal-content h4 { margin: 0 0 10px 0; color: #1e293b; font-size: 15px; }
        .modal-content p { margin: 0 0 20px 0; font-size: 13px; color: #64748b; line-height: 1.5; }
        .modal-btns { display: flex; gap: 10px; }
        .modal-btns button { flex: 1; padding: 10px; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; border: none; }
        .btn-confirm { background: #ef4444; color: white; }
        .btn-confirm:hover { background: #dc2626; }
        .btn-cancel { background: #f1f5f9; color: #64748b; }
        .btn-cancel:hover { background: #e2e8f0; }
    </style>
</head>
<body>
    <div id="confirm-modal" class="modal-overlay">
        <div class="modal-content">
            <h4>确认同步？</h4>
            <p>这将清空您浏览器当前的<b>“书签栏”</b>并由 Lens 中的书签覆盖。此操作不可逆。</p>
            <div class="modal-btns">
                <button id="modal-cancel" class="btn-cancel">取消</button>
                <button id="modal-confirm" class="btn-confirm">确定覆盖</button>
            </div>
        </div>
    </div>
    <div class="header">
        <h3 id="view-title">添加到 Lens</h3>
        <div id="toggle-config" class="gear-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
        </div>
    </div>

    <div id="main-tabs" class="tabs">
        <div class="tab active" data-type="nav">网址导航</div>
        <div class="tab" data-type="bookmark">书签同步</div>
    </div>

    <div class="content">
        <!-- 收藏视图 -->
        <div id="add-view" class="view active">
            <div class="preview">
                <img id="icon-img" src="icon48.png">
                <div id="icon-status" style="font-size: 11px; color: #64748b;">正在识别图标...</div>
            </div>
            <div class="field">
                <label>标题</label>
                <input type="text" id="title">
            </div>
            
            <!-- 导航特有字段 -->
            <div id="nav-fields" class="field">
                <label>保存到分类</label>
                <select id="category"><option>加载分类中...</option></select>
            </div>

            <!-- 书签特有字段 -->
            <div id="bookmark-fields" class="field" style="display: none;">
                <label>保存到文件夹</label>
                <select id="folder"><option value="">根目录</option></select>
            </div>

            <button id="save-site" class="btn">确认保存</button>
            <div id="add-status" class="status"></div>
        </div>

        <!-- 设置视图 -->
        <div id="config-view" class="view">
            <div class="field">
                <label>Lens 服务器地址</label>
                <input type="text" id="base-url" placeholder="http://192.168.x.x:6565">
                <p style="font-size: 11px; color: #94a3b8; margin: 4px 0;">必须包含 http:// 和 端口号</p>
            </div>
            <div class="field" style="flex-direction: row; align-items: center; gap: 8px;">
                <input type="checkbox" id="append-home" style="width: auto;">
                <label style="cursor: pointer;" for="append-home">自动进入 /home 页面</label>
            </div>
            <button id="sync-to-browser" class="btn" style="background: #10b981;">同步书签到浏览器书签栏</button>
            <button id="save-config" class="btn">保存配置</button>
            <button id="back-to-add" class="btn btn-secondary">返回</button>
            <div id="config-status" class="status"></div>
        </div>
    </div>
    <script src="popup.js"></script>
</body>
</html>